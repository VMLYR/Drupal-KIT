name: Profile Install Test
run-name: Testing installing the Enterprise profile.
on: [push]
env:
  LANDO_VERSION: v3.14.0
jobs:
  Install-Lando-And-Test:
    runs-on: ubuntu-latest
    steps:
      - name: Grab latest edge Lando CLI
        run: |
          sudo curl -fsSL -o /usr/local/bin/lando "https://files.lando.dev/cli/lando-linux-x64-edge"
          sudo chmod +x /usr/local/bin/lando    
      - name: Move in lando config appropriate for testing
        run: |
          mkdir -p ~/.lando/cache
          echo false > ~/.lando/cache/report_errors
          lando --clear
      - name: Verify Lando works and we are dogfooding this plugin for tests
        run: |
          lando version
      - name: Cache Composer packages
        id: composer-cache
        uses: actions/cache@v3
        with:
          path: vendor
          key: ${{ runner.os }}-php-${{ hashFiles('**/composer.lock') }}
          restore-keys: | 
              ${{ runner.os }}-php-
      - name: Check out repository code
        uses: actions/checkout@v3
      - name: Copy Lando Yml
        run: cp .lando.profile.yml .lando.local.yml
      - name: Start Lando
        run: |
          lando start
